<section id="try-on-app">
    <h2>Virtual Lip Try-On<br><span style="font-size:0.6em; color:#888;">ç·šä¸Šå”‡è‰²æ¨¡æ“¬é«”é©—</span></h2>
    <p style="text-align:center; margin-bottom:20px; font-size:0.9em;">
        ä¸Šå‚³ç…§ç‰‡ â¤ èª¿æ•´å”‡å‹ä½ç½® â¤ æŒ‘é¸é¡è‰²<br>
        <small>*æ¨¡æ“¬åƒ…ä¾›åƒè€ƒï¼Œå¯¦éš›æˆè‰²ä»¥ç¾å ´è«®è©¢ç‚ºä¸»</small>
    </p>

    <div class="app-container">
        <div class="preview-box">
            <p id="upload-hint">ğŸ“· é»æ­¤ä¸Šå‚³æˆ–æ˜¯æ‹æ”ä¸€å¼µæ­£è‡‰ç…§</p>
            <img id="user-photo" src="" style="display:none;">
            
            <div id="lip-mask" class="lip-overlay">
                <svg viewBox="0 0 200 100" preserveAspectRatio="none">
                    <path d="M10,40 Q50,60 100,40 Q150,60 190,40 Q150,80 100,90 Q50,80 10,40 Z M15,40 Q50,20 100,30 Q150,20 185,40 Q150,50 100,50 Q50,50 15,40" />
                </svg>
            </div>
            <input type="file" id="photo-input" accept="image/*">
        </div>

        <div class="controls" id="control-panel" style="display:none;">
            
            <div class="color-palette">
                <div class="color-btn" style="background:#E59595;" onclick="changeColor('#E59595')" title="ç²‰å«©è‰²"></div>
                <div class="color-btn" style="background:#D65656;" onclick="changeColor('#D65656')" title="ç¶“å…¸ç´…"></div>
                <div class="color-btn" style="background:#E07B5C;" onclick="changeColor('#E07B5C')" title="æš–æ©˜è‰²"></div>
                <div class="color-btn" style="background:#B05C5C;" onclick="changeColor('#B05C5C')" title="ä¹¾ç‡¥ç«ç‘°"></div>
            </div>

            <div class="slider-group">
                <label>å·¦å³ç§»å‹•</label>
                <input type="range" min="0" max="100" value="50" oninput="moveLip('x', this.value)">
            </div>
            <div class="slider-group">
                <label>ä¸Šä¸‹ç§»å‹•</label>
                <input type="range" min="0" max="100" value="50" oninput="moveLip('y', this.value)">
            </div>
            <div class="slider-group">
                <label>ç¸®æ”¾å¤§å°</label>
                <input type="range" min="10" max="150" value="50" oninput="resizeLip(this.value)">
            </div>
            <div class="slider-group">
                <label>é¡è‰²æ¿ƒåº¦</label>
                <input type="range" min="0.1" max="1" step="0.1" value="0.6" oninput="opacityLip(this.value)">
            </div>
        </div>
    </div>
</section>

<style>
    /* è©¦å¦å€å¡Šæ¨£å¼ */
    #try-on-app {
        text-align: center;
        background: #fff5f5;
    }
    
    .app-container {
        max-width: 400px;
        margin: 0 auto;
        background: #fff;
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .preview-box {
        width: 100%;
        height: 300px;
        background-color: #eee;
        border: 2px dashed #ccc;
        border-radius: 10px;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
    }

    #user-photo {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    #upload-hint {
        color: #888;
        font-weight: bold;
        pointer-events: none;
    }

    #photo-input {
        position: absolute;
        width: 100%;
        height: 100%;
        opacity: 0;
        cursor: pointer;
        z-index: 10;
    }

    /* å”‡å‹é®ç½© */
    .lip-overlay {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 80px; /* åˆå§‹å¯¬åº¦ */
        height: 40px; /* åˆå§‹é«˜åº¦ */
        pointer-events: none; /* è®“é»æ“Šç©¿é€ */
        display: none; /* ä¸€é–‹å§‹éš±è— */
        mix-blend-mode: multiply; /* è®“é¡è‰²åƒåŒ–å¦ä¸€æ¨£ç–Šä¸Šå» */
        opacity: 0.6;
    }
    
    .lip-overlay svg {
        width: 100%;
        height: 100%;
        fill: #E59595; /* é è¨­é¡è‰² */
        filter: blur(2px); /* è®“é‚Šç·£æŸ”å’Œä¸€é»æ¯”è¼ƒåƒéœ§å”‡ */
    }

    .controls {
        margin-top: 20px;
    }

    .color-palette {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-bottom: 20px;
    }

    .color-btn {
        width: 35px;
        height: 35px;
        border-radius: 50%;
        cursor: pointer;
        border: 2px solid #fff;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        transition: transform 0.2s;
    }
    .color-btn:hover { transform: scale(1.1); }

    .slider-group {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 10px;
        font-size: 0.85em;
        color: #666;
    }
    .slider-group input { width: 70%; }
</style>

<script>
    // è©¦å¦åŠŸèƒ½çš„ç¨‹å¼é‚è¼¯
    const photoInput = document.getElementById('photo-input');
    const userPhoto = document.getElementById('user-photo');
    const uploadHint = document.getElementById('upload-hint');
    const controlPanel = document.getElementById('control-panel');
    const lipMask = document.getElementById('lip-mask');
    const lipSvg = lipMask.querySelector('svg');

    // 1. è™•ç†ç…§ç‰‡ä¸Šå‚³
    photoInput.addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                userPhoto.src = e.target.result;
                userPhoto.style.display = 'block';
                uploadHint.style.display = 'none';
                controlPanel.style.display = 'block'; // é¡¯ç¤ºæ§åˆ¶é …
                lipMask.style.display = 'block'; // é¡¯ç¤ºå˜´å”‡
            }
            reader.readAsDataURL(file);
        }
    });

    // 2. æ”¹è®Šé¡è‰²
    function changeColor(color) {
        lipSvg.style.fill = color;
    }

    // 3. ç§»å‹•å˜´å”‡ä½ç½®
    function moveLip(axis, val) {
        if(axis === 'x') {
            lipMask.style.left = val + '%';
        } else {
            lipMask.style.top = val + '%';
        }
    }

    // 4. èª¿æ•´å¤§å°
    function resizeLip(val) {
        lipMask.style.width = (val * 1.6) + 'px';
        lipMask.style.height = (val * 0.8) + 'px';
    }

    // 5. èª¿æ•´æ¿ƒåº¦
    function opacityLip(val) {
        lipMask.style.opacity = val;
    }
</script>
